// ¡DO NOT EDIT!
// Generated by `./gradlew buildTracer`
//
var remainingTracerSdk=function(e){"use strict";function t(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t,n){return t&&function(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,o(i.key),i)}}(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function o(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var o=n.call(e,t);if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e,"string");return"symbol"==typeof t?t:t+""}function i(e){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i(e)}var r;function a(){if(r||(r={instance:{}}),"undefined"==typeof window)return r;var e="TracerSDK_2_1_x";return window[e]||(window[e]=r),window[e]}function s(e){var t=a(),n=t.instance[e];return n||(n={inner:{},modules:{},version:"2.1.0"},t.instance[e]=n),n}function l(e){return s(e).inner}function u(e,t,n){var o=l(e);return o[t]||(o[t]=n(e)),o[t]}function d(e,t){return l(e)[t]}var c,p="tracerMain",b={},f=function(){return n((function e(){t(this,e),this.data={}}),[{key:"getItem",value:function(e){return this.data[e]||null}},{key:"removeItem",value:function(e){this.data[e]=void 0}},{key:"setItem",value:function(e,t){this.data[e]=t}}])}();function h(){if(!c){var e=a();(c=e.ls)||(c=function(){var e;try{if("undefined"==typeof window)return new f;e=window.localStorage;var t="__ls_tracer_test";return e.setItem(t,t),e.getItem(t)!==t?new f:(e.removeItem(t),e)}catch(e){return new f}}(),e.ls=c)}return c}function m(e){return"tracer-mute-"+e}function v(e){var t=h().getItem(m(e));return t?parseInt(t):null}function S(e){return!("all"===e||!y("all"))||y(e)}function y(e){var t=b[e];return void 0===t&&(b[e]=t=v(e)),!!t&&(Date.now()<t||(function(e){b[e]=null,h().removeItem(m(e))}(e),!1))}function g(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){var t=16*Math.random()|0;return("x"==e?t:3&t|8).toString(16)}))}var x,w="tracer-device-id";function k(){var e=h(),t=e.getItem(w);return t||(t=g(),e.setItem(w,t)),t}function O(e){return e.getFullYear()+"-"+B(e.getMonth()+1)+"-"+B(e.getDate())+"T"+B(e.getHours())+":"+B(e.getMinutes())+":"+B(e.getSeconds())+function(e){if(0===e)return"Z";var t=e>0?"-":"+";return e=Math.abs(e),t+B(Math.floor(e/60))+":"+B(e%60)}(e.getTimezoneOffset())}function B(e){return e<10?"0"+e:e}function E(e,t,n){var o=new Blob([e]);if("undefined"!=typeof window&&Boolean(window.CompressionStream))try{T(o.stream().pipeThrough(new CompressionStream("gzip")).getReader()).then(t,(function(){n(o)}))}catch(e){n(o)}else n(o)}function T(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return e.read().then((function(n){return n.value&&t.push(n.value),n.done?new Blob(t):T(e,t)}))}function M(){var e=a();return e.sessionUuid||(e.sessionUuid=g()),e.sessionUuid}function C(){if(x)return x;var t={function:!0,object:!0},n=t["undefined"==typeof window?"undefined":i(window)]&&window||this,o=t[void 0===e?"undefined":i(e)]&&e,r=t["undefined"==typeof module?"undefined":i(module)]&&module&&!module.nodeType&&module,a=o&&r&&"object"==("undefined"==typeof global?"undefined":i(global))&&global;!a||a.global!==a&&a.window!==a&&a.self!==a||(n=a);var s=Math.pow(2,53)-1,l=/\bOpera/,u=Object.prototype,d=u.hasOwnProperty,c=u.toString;function p(e){return(e=String(e)).charAt(0).toUpperCase()+e.slice(1)}function b(e){return e=S(e),/^(?:webOS|i(?:OS|P))/.test(e)?e:p(e)}function f(e,t){for(var n in e)d.call(e,n)&&t(e[n],n,e)}function h(e){return null==e?p(e):c.call(e).slice(8,-1)}function m(e){return String(e).replace(/([ -])(?!$)/g,"$1?")}function v(e,t){var n=null;return function(e,t){var n=-1,o=e?e.length:0;if("number"==typeof o&&o>-1&&o<=s)for(;++n<o;)t(e[n],n,e);else f(e,t)}(e,(function(o,i){n=t(n,o,i,e)})),n}function S(e){return String(e).replace(/^ +| +$/g,"")}return x=function e(t){var o=n,r=t&&"object"==i(t)&&"String"!=h(t);r&&(o=t,t=null);var a=o.navigator||{},s=a.userAgent||"";t||(t=s);var u,d,p,y,g,x=r?!!a.likeChrome:/\bChrome\b/.test(t)&&!/internal|\n/i.test(c.toString()),w="Object",k=r?w:"ScriptBridgingProxyObject",O=r?w:"Environment",B=r&&o.java?"JavaPackage":h(o.java),E=r?w:"RuntimeObject",T=/\bJava/.test(B)&&o.java,M=T&&h(o.environment)==O,C=T?"a":"α",I=T?"b":"β",P=o.document||{},U=o.operamini||o.opera,R=l.test(R=r&&U?U["[[Class]]"]:h(U))?R:U=null,A=t,W=[],F=null,N=t==s,H=N&&U&&"function"==typeof U.version&&U.version(),j=v([{label:"EdgeHTML",pattern:"Edge"},"Trident",{label:"WebKit",pattern:"AppleWebKit"},"iCab","Presto","NetFront","Tasman","KHTML","Gecko"],(function(e,n){return e||RegExp("\\b"+(n.pattern||m(n))+"\\b","i").exec(t)&&(n.label||n)})),_=function(e){return v(e,(function(e,n){return e||RegExp("\\b"+(n.pattern||m(n))+"\\b","i").exec(t)&&(n.label||n)}))}(["Adobe AIR","Arora","Avant Browser","Breach","Camino","Electron","Epiphany","Fennec","Flock","Galeon","GreenBrowser","iCab","Iceweasel","K-Meleon","Konqueror","Lunascape","Maxthon",{label:"Microsoft Edge",pattern:"(?:Edge|Edg|EdgA|EdgiOS)"},"Midori","Nook Browser","PaleMoon","PhantomJS","Raven","Rekonq","RockMelt",{label:"Samsung Internet",pattern:"SamsungBrowser"},"SeaMonkey",{label:"Silk",pattern:"(?:Cloud9|Silk-Accelerated)"},"Sleipnir","SlimBrowser",{label:"SRWare Iron",pattern:"Iron"},"Sunrise","Swiftfox","Vivaldi","Waterfox","WebPositive",{label:"Yandex Browser",pattern:"YaBrowser"},{label:"UC Browser",pattern:"UCBrowser"},"Opera Mini",{label:"Opera Mini",pattern:"OPiOS"},"Opera",{label:"Opera",pattern:"OPR"},"Chromium","Chrome",{label:"Chrome",pattern:"(?:HeadlessChrome)"},{label:"Chrome Mobile",pattern:"(?:CriOS|CrMo)"},{label:"Firefox",pattern:"(?:Firefox|Minefield)"},{label:"Firefox for iOS",pattern:"FxiOS"},{label:"IE",pattern:"IEMobile"},{label:"IE",pattern:"MSIE"},"Safari"]),G=$([{label:"BlackBerry",pattern:"BB10"},"BlackBerry",{label:"Galaxy S",pattern:"GT-I9000"},{label:"Galaxy S2",pattern:"GT-I9100"},{label:"Galaxy S3",pattern:"GT-I9300"},{label:"Galaxy S4",pattern:"GT-I9500"},{label:"Galaxy S5",pattern:"SM-G900"},{label:"Galaxy S6",pattern:"SM-G920"},{label:"Galaxy S6 Edge",pattern:"SM-G925"},{label:"Galaxy S7",pattern:"SM-G930"},{label:"Galaxy S7 Edge",pattern:"SM-G935"},"Google TV","Lumia","iPad","iPod","iPhone","Kindle",{label:"Kindle Fire",pattern:"(?:Cloud9|Silk-Accelerated)"},"Nexus","Nook","PlayBook","PlayStation Vita","PlayStation","TouchPad","Transformer",{label:"Wii U",pattern:"WiiU"},"Wii","Xbox One",{label:"Xbox 360",pattern:"Xbox"},"Xoom"]),K=function(e){return v(e,(function(e,n,o){return e||(n[G]||n[/^[a-z]+(?: +[a-z]+\b)*/i.exec(G)]||RegExp("\\b"+m(o)+"(?:\\b|\\w*\\d)","i").exec(t))&&o}))}({Apple:{iPad:1,iPhone:1,iPod:1},Alcatel:{},Archos:{},Amazon:{Kindle:1,"Kindle Fire":1},Asus:{Transformer:1},"Barnes & Noble":{Nook:1},BlackBerry:{PlayBook:1},Google:{"Google TV":1,Nexus:1},HP:{TouchPad:1},HTC:{},Huawei:{},Lenovo:{},LG:{},Microsoft:{Xbox:1,"Xbox One":1},Motorola:{Xoom:1},Nintendo:{"Wii U":1,Wii:1},Nokia:{Lumia:1},Oppo:{},Samsung:{"Galaxy S":1,"Galaxy S2":1,"Galaxy S3":1,"Galaxy S4":1},Sony:{PlayStation:1,"PlayStation Vita":1},Xiaomi:{Mi:1,Redmi:1}}),D=function(e){return v(e,(function(e,n){var o=n.pattern||m(n);return!e&&(e=RegExp("\\b"+o+"(?:/[\\d.]+|[ \\w.]*)","i").exec(t))&&(e=function(e,t,n){var o={"10.0":"10",6.4:"10 Technical Preview",6.3:"8.1",6.2:"8",6.1:"Server 2008 R2 / 7","6.0":"Server 2008 / Vista",5.2:"Server 2003 / XP 64-bit",5.1:"XP",5.01:"2000 SP1","5.0":"2000","4.0":"NT","4.90":"ME"};return t&&n&&/^Win/i.test(e)&&!/^Windows Phone /i.test(e)&&(o=o[/[\d.]+$/.exec(e)])&&(e="Windows "+o),e=String(e),t&&n&&(e=e.replace(RegExp(t,"i"),n)),b(e.replace(/ ce$/i," CE").replace(/\bhpw/i,"web").replace(/\bMacintosh\b/,"Mac OS").replace(/_PowerPC\b/i," OS").replace(/\b(OS X) [^ \d]+/i,"$1").replace(/\bMac (OS X)\b/,"$1").replace(/\/(\d)/," $1").replace(/_/g,".").replace(/(?: BePC|[ .]*fc[ \d.]+)$/i,"").replace(/\bx86\.64\b/gi,"x86_64").replace(/\b(Windows Phone) OS\b/,"$1").replace(/\b(Chrome OS \w+) [\d.]+\b/,"$1").split(" on ")[0])}(e,o,n.label||n)),e}))}(["Windows Phone","KaiOS","Android","CentOS",{label:"Chrome OS",pattern:"CrOS"},"Debian",{label:"DragonFly BSD",pattern:"DragonFly"},"Fedora","FreeBSD","Gentoo","Haiku","Kubuntu","Linux Mint","OpenBSD","Red Hat","SuSE","Ubuntu","Xubuntu","Cygwin","Symbian OS","hpwOS","webOS ","webOS","Tablet OS","Tizen","Linux","Mac OS X","Macintosh","Mac","Windows 98;","Windows "]);function $(e){return v(e,(function(e,n){var o=n.pattern||m(n);return!e&&(e=RegExp("\\b"+o+" *\\d+[.\\w_]*","i").exec(t)||RegExp("\\b"+o+" *\\w+-[\\w]*","i").exec(t)||RegExp("\\b"+o+"(?:; *(?:[a-z]+[_-])?[a-z]+\\d+|[^ ();-]*)","i").exec(t))&&((e=String(n.label&&!RegExp(o,"i").test(n.label)?n.label:e).split("/"))[1]&&!/[\d.]+/.test(e[0])&&(e[0]+=" "+e[1]),n=n.label||n,e=b(e[0].replace(RegExp(o,"i"),n).replace(RegExp("; *(?:"+n+"[_-])?","i")," ").replace(RegExp("("+n+")[-_.]?(\\w)","i"),"$1 $2"))),e}))}function L(e){return v(e,(function(e,n){return e||(RegExp(n+"(?:-[\\d.]+/|(?: for [\\w-]+)?[ /-])([\\d.]+[^ ();/_-]*)","i").exec(t)||0)[1]||null}))}if(j&&(j=[j]),/\bAndroid\b/.test(D)&&!G&&(u=/\bAndroid[^;]*;(.*?)(?:Build|\) AppleWebKit)\b/i.exec(t))&&(G=S(u[1]).replace(/^[a-z]{2}-[a-z]{2};\s*/i,"")||null),K&&!G?G=$([K]):K&&G&&(G=G.replace(RegExp("^("+m(K)+")[-_.\\s]","i"),K+" ").replace(RegExp("^("+m(K)+")[-_.]?(\\w)","i"),K+" $2")),(u=/\bGoogle TV\b/.exec(G))&&(G=u[0]),/\bSimulator\b/i.test(t)&&(G=(G?G+" ":"")+"Simulator"),"Opera Mini"==_&&/\bOPiOS\b/.test(t)&&W.push("running in Turbo/Uncompressed mode"),"IE"==_&&/\blike iPhone OS\b/.test(t)?(K=(u=e(t.replace(/like iPhone OS/,""))).manufacturer,G=u.product):/^iP/.test(G)?(_||(_="Safari"),D="iOS"+((u=/ OS ([\d_]+)/i.exec(t))?" "+u[1].replace(/_/g,"."):"")):"Konqueror"==_&&/^Linux\b/i.test(D)?D="Kubuntu":K&&"Google"!=K&&(/Chrome/.test(_)&&!/\bMobile Safari\b/i.test(t)||/\bVita\b/.test(G))||/\bAndroid\b/.test(D)&&/^Chrome/.test(_)&&/\bVersion\//i.test(t)?(_="Android Browser",D=/\bAndroid\b/.test(D)?D:"Android"):"Silk"==_?(/\bMobi/i.test(t)||(D="Android",W.unshift("desktop mode")),/Accelerated *= *true/i.test(t)&&W.unshift("accelerated")):"UC Browser"==_&&/\bUCWEB\b/.test(t)?W.push("speed mode"):"PaleMoon"==_&&(u=/\bFirefox\/([\d.]+)\b/.exec(t))?W.push("identifying as Firefox "+u[1]):"Firefox"==_&&(u=/\b(Mobile|Tablet|TV)\b/i.exec(t))?(D||(D="Firefox OS"),G||(G=u[1])):!_||(u=!/\bMinefield\b/i.test(t)&&/\b(?:Firefox|Safari)\b/.exec(_))?(_&&!G&&/[\/,]|^[^(]+?\)/.test(t.slice(t.indexOf(u+"/")+8))&&(_=null),(u=G||K||D)&&(G||K||/\b(?:Android|Symbian OS|Tablet OS|webOS)\b/.test(D))&&(_=/[a-z]+(?: Hat)?/i.exec(/\bAndroid\b/.test(D)?D:u)+" Browser")):"Electron"==_&&(u=(/\bChrome\/([\d.]+)\b/.exec(t)||0)[1])&&W.push("Chromium "+u),H||(H=L(["(?:Cloud9|CriOS|CrMo|Edge|Edg|EdgA|EdgiOS|FxiOS|HeadlessChrome|IEMobile|Iron|Opera ?Mini|OPiOS|OPR|Raven|SamsungBrowser|Silk(?!/[\\d.]+$)|UCBrowser|YaBrowser)","Version",m(_),"(?:Firefox|Minefield|NetFront)"])),(u=("iCab"==j&&parseFloat(H)>3?"WebKit":/\bOpera\b/.test(_)&&(/\bOPR\b/.test(t)?"Blink":"Presto"))||/\b(?:Midori|Nook|Safari)\b/i.test(t)&&!/^(?:Trident|EdgeHTML)$/.test(j)&&"WebKit"||!j&&/\bMSIE\b/i.test(t)&&("Mac OS"==D?"Tasman":"Trident")||"WebKit"==j&&/\bPlayStation\b(?! Vita\b)/i.test(_)&&"NetFront")&&(j=[u]),"IE"==_&&(u=(/; *(?:XBLWP|ZuneWP)(\d+)/i.exec(t)||0)[1])?(_+=" Mobile",D="Windows Phone "+(/\+$/.test(u)?u:u+".x"),W.unshift("desktop mode")):/\bWPDesktop\b/i.test(t)?(_="IE Mobile",D="Windows Phone 8.x",W.unshift("desktop mode"),H||(H=(/\brv:([\d.]+)/.exec(t)||0)[1])):"IE"!=_&&"Trident"==j&&(u=/\brv:([\d.]+)/.exec(t))&&(_&&W.push("identifying as "+_+(H?" "+H:"")),_="IE",H=u[1]),N){if(y="global",g=null!=(p=o)?i(p[y]):"number",/^(?:boolean|number|string|undefined)$/.test(g)||"object"==g&&!p[y])h(u=o.runtime)==k?(_="Adobe AIR",D=u.flash.system.Capabilities.os):h(u=o.phantom)==E?(_="PhantomJS",H=(u=u.version||null)&&u.major+"."+u.minor+"."+u.patch):"number"==typeof P.documentMode&&(u=/\bTrident\/(\d+)/i.exec(t))?(H=[H,P.documentMode],(u=+u[1]+4)!=H[1]&&(W.push("IE "+H[1]+" mode"),j&&(j[1]=""),H[1]=u),H="IE"==_?String(H[1].toFixed(1)):H[0]):"number"==typeof P.documentMode&&/^(?:Chrome|Firefox)\b/.test(_)&&(W.push("masking as "+_+" "+H),_="IE",H="11.0",j=["Trident"],D="Windows");else if(T&&(A=(u=T.lang.System).getProperty("os.arch"),D=D||u.getProperty("os.name")+" "+u.getProperty("os.version")),M){try{H=o.require("ringo/engine").version.join("."),_="RingoJS"}catch(e){(u=o.system)&&u.global.system==o.system&&(_="Narwhal",D||(D=u[0].os||null))}_||(_="Rhino")}else"object"==i(o.process)&&!o.process.browser&&(u=o.process)&&("object"==i(u.versions)&&("string"==typeof u.versions.electron?(W.push("Node "+u.versions.node),_="Electron",H=u.versions.electron):"string"==typeof u.versions.nw&&(W.push("Chromium "+H,"Node "+u.versions.node),_="NW.js",H=u.versions.nw)),_||(_="Node.js",A=u.arch,D=u.platform,H=(H=/[\d.]+/.exec(u.version))?H[0]:null));D=D&&b(D)}if(H&&(u=/(?:[ab]|dp|pre|[ab]\d+pre)(?:\d+\+?)?$/i.exec(H)||/(?:alpha|beta)(?: ?\d)?/i.exec(t+";"+(N&&a.appMinorVersion))||/\bMinefield\b/i.test(t)&&"a")&&(F=/b/i.test(u)?"beta":"alpha",H=H.replace(RegExp(u+"\\+?$"),"")+("beta"==F?I:C)+(/\d+\+?/.exec(u)||"")),"Fennec"==_||"Firefox"==_&&/\b(?:Android|Firefox OS|KaiOS)\b/.test(D))_="Firefox Mobile";else if("Maxthon"==_&&H)H=H.replace(/\.[\d.]+/,".x");else if(/\bXbox\b/i.test(G))"Xbox 360"==G&&(D=null),"Xbox 360"==G&&/\bIEMobile\b/.test(t)&&W.unshift("mobile mode");else if(!/^(?:Chrome|IE|Opera)$/.test(_)&&(!_||G||/Browser|Mobi/.test(_))||"Windows CE"!=D&&!/Mobi/i.test(t))if("IE"==_&&N)try{null===o.external&&W.unshift("platform preview")}catch(e){W.unshift("embedded")}else(/\bBlackBerry\b/.test(G)||/\bBB10\b/.test(t))&&(u=(RegExp(G.replace(/ +/g," *")+"/([.\\d]+)","i").exec(t)||0)[1]||H)?(D=((u=[u,/BB10/.test(t)])[1]?(G=null,K="BlackBerry"):"Device Software")+" "+u[0],H=null):this!=f&&"Wii"!=G&&(N&&U||/Opera/.test(_)&&/\b(?:MSIE|Firefox)\b/i.test(t)||"Firefox"==_&&/\bOS X (?:\d+\.){2,}/.test(D)||"IE"==_&&(D&&!/^Win/.test(D)&&H>5.5||/\bWindows XP\b/.test(D)&&H>8||8==H&&!/\bTrident\b/.test(t)))&&!l.test(u=e.call(f,t.replace(l,"")+";"))&&u.name&&(u="ing as "+u.name+((u=u.version)?" "+u:""),l.test(_)?(/\bIE\b/.test(u)&&"Mac OS"==D&&(D=null),u="identify"+u):(u="mask"+u,_=R?b(R.replace(/([a-z])([A-Z])/g,"$1 $2")):"Opera",/\bIE\b/.test(u)&&(D=null),N||(H=null)),j=["Presto"],W.push(u));else _+=" Mobile";(u=(/\bAppleWebKit\/([\d.]+\+?)/i.exec(t)||0)[1])&&(u=[parseFloat(u.replace(/\.(\d)$/,".0$1")),u],"Safari"==_&&"+"==u[1].slice(-1)?(_="WebKit Nightly",F="alpha",H=u[1].slice(0,-1)):H!=u[1]&&H!=(u[2]=(/\bSafari\/([\d.]+\+?)/i.exec(t)||0)[1])||(H=null),u[1]=(/\b(?:Headless)?Chrome\/([\d.]+)/i.exec(t)||0)[1],537.36==u[0]&&537.36==u[2]&&parseFloat(u[1])>=28&&"WebKit"==j&&(j=["Blink"]),N&&(x||u[1])?(j&&(j[1]="like Chrome"),u=u[1]||((u=u[0])<530?1:u<532?2:u<532.05?3:u<533?4:u<534.03?5:u<534.07?6:u<534.1?7:u<534.13?8:u<534.16?9:u<534.24?10:u<534.3?11:u<535.01?12:u<535.02?"13+":u<535.07?15:u<535.11?16:u<535.19?17:u<536.05?18:u<536.1?19:u<537.01?20:u<537.11?"21+":u<537.13?23:u<537.18?24:u<537.24?25:u<537.36?26:"Blink"!=j?"27":"28")):(j&&(j[1]="like Safari"),u=(u=u[0])<400?1:u<500?2:u<526?3:u<533?4:u<534?"4+":u<535?5:u<537?6:u<538?7:u<601?8:u<602?9:u<604?10:u<606?11:u<608?12:"12"),j&&(j[1]+=" "+(u+="number"==typeof u?".x":/[.+]/.test(u)?"":"+")),"Safari"==_&&(!H||parseInt(H)>45)?H=u:"Chrome"==_&&/\bHeadlessChrome/i.test(t)&&W.unshift("headless")),"Opera"==_&&(u=/\bzbov|zvav$/.exec(D))?(_+=" ",W.unshift("desktop mode"),"zvav"==u?(_+="Mini",H=null):_+="Mobile",D=D.replace(RegExp(" *"+u+"$"),"")):"Safari"==_&&/\bChrome\b/.exec(j&&j[1])?(W.unshift("desktop mode"),_="Chrome Mobile",H=null,/\bOS X\b/.test(D)?(K="Apple",D="iOS 4.3+"):D=null):/\bSRWare Iron\b/.test(_)&&!H&&(H=L("Chrome")),H&&0==H.indexOf(u=/[\d.]+$/.exec(D))&&t.indexOf("/"+u+"-")>-1&&(D=S(D.replace(u,""))),D&&-1!=D.indexOf(_)&&!RegExp(_+" OS").test(D)&&(D=D.replace(RegExp(" *"+m(_)+" *"),"")),j&&!/\b(?:Avant|Nook)\b/.test(_)&&(/Browser|Lunascape|Maxthon/.test(_)||"Safari"!=_&&/^iOS/.test(D)&&/\bSafari\b/.test(j[1])||/^(?:Adobe|Arora|Breach|Midori|Opera|Phantom|Rekonq|Rock|Samsung Internet|Sleipnir|SRWare Iron|Vivaldi|Web)/.test(_)&&j[1])&&(u=j[j.length-1])&&W.push(u),W.length&&(W=["("+W.join("; ")+")"]),K&&G&&G.indexOf(K)<0&&W.push("on "+K),G&&W.push((/^on /.test(W[W.length-1])?"":"on ")+G),D&&(u=/ ([\d.+]+)$/.exec(D),d=u&&"/"==D.charAt(D.length-u[0].length-1),D={architecture:32,family:u&&!d?D.replace(u[0],""):D,version:u?u[1]:null,toString:function(){var e=this.version;return this.family+(e&&!d?" "+e:"")+(64==this.architecture?" 64-bit":"")}}),(u=/\b(?:AMD|IA|Win|WOW|x86_|x)64\b/i.exec(A))&&!/\bi686\b/i.test(A)?(D&&(D.architecture=64,D.family=D.family.replace(RegExp(" *"+u),"")),_&&(/\bWOW64\b/i.test(t)||N&&/\w(?:86|32)$/.test(a.cpuClass||a.platform)&&!/\bWin64; x64\b/i.test(t))&&W.unshift("32-bit")):D&&/^OS X/.test(D.family)&&"Chrome"==_&&parseFloat(H)>=39&&(D.architecture=64),t||(t=null);var V={};return V.description=t,V.layout=j&&j[0],V.manufacturer=K,V.name=_,V.prerelease=F,V.product=G,V.ua=t,V.version=_&&H,V.os=D||{architecture:null,family:null,version:null,toString:function(){return"null"}},V.parse=e,V.toString=function(){return this.description||""},V.version&&W.unshift(H),V.name&&W.unshift(_),D&&_&&(D!=String(D).split(" ")[0]||D!=_.split(" ")[0]&&!G)&&W.push(G?"("+D+")":"on "+D),W.length&&(V.description=W.join(" ")),V}(),x}function I(e){return"https://"+(e.apiHost||"sdk-api.apptracer.ru")+e.apiUrl+function(e){var t=e.queryParams||{},n=[];for(var o in e.sdkVersion&&(t.sdkVersion=e.sdkVersion),t)Object.prototype.hasOwnProperty.call(t,o)&&t[o]&&n.push(o+"="+t[o]);return n.length?"?"+n.join("&"):""}(e)}function P(e,t){if(!b[e]){var n=m(e),o=v(e);if(o)b[e]=o;else{var i=b[e]=Date.now()+t;h().setItem(n,String(i))}}}function U(e){var t,n=I(e),o=function(e){if("form"===e.dataType){var t=new FormData;for(var n in e.data)if(Object.prototype.hasOwnProperty.call(e.data,n)){var o=e.data[n];"object"!==i(o)||o instanceof Blob||(o=JSON.stringify(o)),t.append(n,o)}return t}return"blob"===e.dataType?e.data:JSON.stringify(e.data)}(e),r=e.onRequestEnd,a={},s=1e4,l=e.retryCount||1/0,u="Content-Type";function d(){var e=new XMLHttpRequest;for(var t in e.open("POST",n),a)Object.prototype.hasOwnProperty.call(a,t)&&a[t]&&e.setRequestHeader(t,a[t]);return e.responseType="json",e.onload=p,e.onerror=p,e.onabort=p,e.ontimeout=p,e.send(o),e}function c(){s=Math.min(2*s,3e5),l--,t=d()}function p(n){if(t)if(("timeout"===n.type||"error"===n.type&&t.readyState===XMLHttpRequest.DONE&&0===t.status)&&l>0)setTimeout(c,s);else{"undefined"!=typeof window&&window.removeEventListener("beforeunload",b);try{var o=t.response;if(o.commands){var i=o.commands.globalShutdownMs;i&&P("all",i);var a=o.commands.featureShutdownMs;a&&e.onMute(a)}}catch(e){}r&&r()}}function b(){if(navigator.sendBeacon)if(t&&t.abort(),"string"==typeof o||o instanceof Blob){var e=a[u];navigator.sendBeacon(n,new Blob([o],e?{type:e}:void 0))}else navigator.sendBeacon(n,o);else t||(t=d())}"json"===e.dataType?a[u]="application/json;charset=utf-8":"blob"===e.dataType&&(a[u]="application/octet-stream"),e.beforeUnload?b():("undefined"!=typeof window&&window.addEventListener("beforeunload",b),t=d())}function R(e){"undefined"!=typeof window&&U(e)}function A(e){return s(e).version}var W=function(){return n((function e(n,o){t(this,e),this.CRASH_BATCH_SIZE=20,this.UPLOAD_BATCH_TIMEOUT_MS=15e3,this.THROTTLE_INTERVAL_MS=1e4,this.beforeUnload=!1,this.stackTraceHashTime={},this.sdkKey=n,this.environment=o.environment,this.appToken=o.appToken,this.versionName=o.versionName,this.versionCode=o.versionCode,this.apiHost=o.apiHost,this.uploadBatch=this.uploadBatch.bind(this),this.onUploadBatchEnd=this.onUploadBatchEnd.bind(this),this.onBatchDataEncoded=this.onBatchDataEncoded.bind(this),this.onBeforeUnload=this.onBeforeUnload.bind(this),"undefined"!=typeof window&&window.addEventListener("beforeunload",this.onBeforeUnload),this.setUploadTask(1e3)}),[{key:"onBeforeUnload",value:function(){this.beforeUnload=!0,this.uploadBatch()}},{key:"destroy",value:function(){clearTimeout(this.uploadBatchTimeout),"undefined"!=typeof window&&window.removeEventListener("beforeunload",this.onBeforeUnload)}},{key:"setUploadTask",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.UPLOAD_BATCH_TIMEOUT_MS;clearTimeout(this.uploadBatchTimeout),this.beforeUnload||(this.uploadBatchTimeout=setTimeout(this.uploadBatch,e))}},{key:"forceUpload",value:function(){clearTimeout(this.uploadBatchTimeout),this.uploadBatch()}},{key:"uploadBatch",value:function(){var e=d(this.sdkKey,1);if(e&&!S("crashUpload")){var t=this.getFilteredRawBatchData(e.dequeue(this.CRASH_BATCH_SIZE));t.length?this.encodeBatchDataItems(t,this.onBatchDataEncoded):this.setUploadTask()}else this.setUploadTask()}},{key:"onBatchDataEncoded",value:function(e){E(JSON.stringify(e),this.runUpload.bind(this,"GZIP"),this.runUpload.bind(this,"NONE"))}},{key:"runUpload",value:function(e,t){R({beforeUnload:this.beforeUnload,sdkVersion:A(this.sdkKey),apiHost:this.apiHost,apiUrl:"/api/crash/uploadBatch",data:t,queryParams:{crashToken:this.appToken,compressType:e},dataType:"blob",onRequestEnd:this.onUploadBatchEnd,onMute:P.bind(null,"crashUpload")})}},{key:"onUploadBatchEnd",value:function(){this.setUploadTask(0)}},{key:"encodeBatchDataItems",value:function(e,t){for(var n=e.length,o=0,i=0;i<n;i++)this.encodeBatchDataItem(e[i],(function(){++o===n&&t(e)}))}},{key:"encodeBatchDataItem",value:function(e,t){if(e.logsFile)return n=e.logsFile,o=function(n){e.logsFile=n,t(e)},(i=new FileReader).onloadend=function(){var e=String(i.result);o(e.slice(e.indexOf("base64,")+7))},void i.readAsDataURL(new Blob([n]));var n,o,i;t(e)}},{key:"getFilteredRawBatchData",value:function(e){if(!e.length)return[];for(var t=[],n=this.getCommonUploadBeanInfo(),o=this.getCommonUploadBeanProperties(),i=0;i<e.length;i++){var r=e[i],a=r.error.name+": "+r.error.message+"\n"+r.errorStack;if(!this.throttleStacktrace(r.errorStack)){var s={type:r.type,uploadBean:this.getUploadBeanForError(r,n,o),stackTrace:a};r.log&&(s.logsFile=r.log),t.push(s)}}return t}},{key:"throttleStacktrace",value:function(e){if(!e)return!0;var t=function(e){for(var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,o=3735928559^n,i=1103547991^n,r=0;r<e.length;r++)t=e.charCodeAt(r),o=Math.imul(o^t,2654435761),i=Math.imul(i^t,1597334677);return o=Math.imul(o^o>>>16,2246822507),o^=Math.imul(i^i>>>13,3266489909),i=Math.imul(i^i>>>16,2246822507),4294967296*(2097151&(i^=Math.imul(o^o>>>13,3266489909)))+(o>>>0)}(e),n=this.stackTraceHashTime,o=n[t],i=Date.now();return!!(o&&i-o<=this.THROTTLE_INTERVAL_MS)||(n[t]=i,!1)}},{key:"getCommonUploadBeanProperties",value:function(){var e,t,n,o=this.getWindowParams(),i=C();return o=Object.assign(Object.assign({},o),{userAgent:i.ua,browserName:i.name,browserVersion:i.version,osFamily:null===(e=i.os)||void 0===e?void 0:e.family,osVersion:null===(t=i.os)||void 0===t?void 0:t.version,osArchitecture:null===(n=i.os)||void 0===n?void 0:n.architecture})}},{key:"getCommonUploadBeanInfo",value:function(){var e,t="unknown",n=C();return{osVersion:(null===(e=n.os)||void 0===e?void 0:e.version)||t,vendor:n.name||t,device:n.version||t}}},{key:"getUploadBeanForError",value:function(e,t,n){var o=[],i=e.keys;if(i)for(var r in i)r&&Object.prototype.hasOwnProperty.call(i,r)&&o.push("".concat(r,"=").concat(i[r]));e.crashIdSource&&(t.crashIdSourceField="crashIdSource",n.crashIdSource=e.crashIdSource);var a=this.sdkKey,s=Object.assign({tracerSdkVersion:A(a),timestamp:e.timestamp,date:O(new Date(e.timestamp)),userId:e.userId?String(e.userId):void 0,issueKey:e.issueKey,errorEventType:e.errorEventType},n);return Object.assign({crashIdSource:e.crashIdSource,environment:this.environment,component:e.component||(a!==p?a:void 0),deviceId:k(),sessionUuid:M(),versionName:e.versionName||this.versionName,versionCode:e.versionCode||this.versionCode,tags:o.length?o:void 0,module:e.module,properties:s},t)}},{key:"getWindowParams",value:function(){if("undefined"!=typeof window){var e=window.screen,t={screenWidth:e.width,screenHeight:e.height,host:window.location.host};return e.orientation&&e.orientation.angle&&(t.screenOrientationAngle=e.orientation.angle),t}return{}}}])}();var F=function(){return n((function e(n,o){t(this,e),this.status="BLANK",this.uploaded=!1,this.beforeUnload=!1,this.sdkKey=n,this.environment=o.environment,this.appToken=o.appToken,this.versionName=o.versionName,this.versionCode=o.versionCode,this.apiHost=o.apiHost,this.onBeforeUnload=this.onBeforeUnload.bind(this);var i=d(this.sdkKey,1);i&&i.withCrashes()&&this.setCrashed(),"undefined"!=typeof window&&window.addEventListener("beforeunload",this.onBeforeUnload)}),[{key:"onBeforeUnload",value:function(){this.beforeUnload=!0,this.upload()}},{key:"setCrashed",value:function(){"CRASH"!==this.status&&(this.status="CRASH",this.upload())}},{key:"destroy",value:function(){"undefined"!=typeof window&&window.removeEventListener("beforeunload",this.onBeforeUnload)}},{key:"upload",value:function(){if(!this.uploaded&&!S("trackSession")){this.uploaded=!0;var e={sessionUuid:M(),versionName:this.versionName,versionCode:String(this.versionCode),status:this.status,environment:this.environment};this.uploadSessionInfo(e)}}},{key:"uploadSessionInfo",value:function(e){var t={};t.versionName=this.versionName,t.versionCode=String(this.versionCode),t.deviceId=k(),t.sessions=[e],R({beforeUnload:this.beforeUnload,sdkVersion:A(this.sdkKey),apiHost:this.apiHost,apiUrl:"/api/crash/trackSession",queryParams:{crashToken:this.appToken},data:t,dataType:"json",onMute:P.bind(null,"trackSession")})}}])}();return e.initTracerErrorUploader=function(e){return function(e,t){u(e,3,(function(){return new W(e,{appToken:t.appToken,apiHost:t.apiHost,versionName:t.versionName,versionCode:t.versionCode,environment:t.environment})}))}(p,e)},e.initTracerSessionUploader=function(e){return function(e,t){u(e,7,(function(){return new F(e,t)}))}(p,e)},e}({});

